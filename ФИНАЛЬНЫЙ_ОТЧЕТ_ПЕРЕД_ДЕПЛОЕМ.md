# üìä –§–ò–ù–ê–õ–¨–ù–´–ô –û–¢–ß–Å–¢: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –¥–µ–ø–ª–æ—é –Ω–∞ Render

## –î–∞—Ç–∞: 2025-12-18

---

## ‚úÖ –í–°–ï 7 –®–ê–ì–û–í –í–´–ü–û–õ–ù–ï–ù–´

### üìå –®–ê–ì 1: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π ‚úÖ

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- ‚úÖ –°–∫—Ä–∏–ø—Ç `scripts/kie_market_crawler.py` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π –∏–∑ KIE API
- ‚úÖ –°–∫—Ä–∏–ø—Ç `scripts/sync_kie_models_from_catalog.py` –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ `kie_models.py`
- ‚úÖ –°–∫—Ä–∏–ø—Ç `scripts/verify_kie_coverage.py` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–∫—Ä—ã—Ç–∏—è
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö 47 –º–æ–¥–µ–ª–µ–π –∏ –∏—Ö modes

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
python scripts/kie_market_crawler.py
python scripts/sync_kie_models_from_catalog.py
python -m scripts.verify_kie_coverage
```

---

### üìå –®–ê–ì 2: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ ‚úÖ

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- ‚úÖ –ú–æ–¥—É–ª—å `error_handler_providers.py` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ `kie_client.py` –∏ `bot_kie.py`
- ‚úÖ –ü–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ—à–∏–±–æ–∫
- ‚úÖ –°–∫—Ä–∏–ø—Ç `scripts/generate_error_report.py` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á—ë—Ç–æ–≤

**–¢–∏–ø—ã –æ—à–∏–±–æ–∫:**
- –û—à–∏–±–∫–∏ API Kie.ai (500, 503, 429, 400, 401, 403)
- –û—à–∏–±–∫–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
- –°–µ—Ç–µ–≤—ã–µ –æ—à–∏–±–∫–∏
- –û—à–∏–±–∫–∏ —Ç–∞–π–º–∞—É—Ç–∞

---

### üìå –®–ê–ì 3: –¢–µ—Å—Ç—ã –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è ‚úÖ

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- ‚úÖ –¢–µ—Å—Ç—ã –≤ `tests/` –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ DRY_RUN —Ä–µ–∂–∏–º–∞
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö callback'–æ–≤
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∫—Ä—ã—Ç–∏—è –º–æ–¥–µ–ª–µ–π

**–ö–æ–º–∞–Ω–¥—ã:**
```bash
make test
# –∏–ª–∏
TEST_MODE=1 DRY_RUN=1 pytest tests/ -v
```

**–ü—Ä–æ–≤–µ—Ä–∫–∏ DRY_RUN:**
- ‚úÖ –ë–∞–ª–∞–Ω—Å –Ω–µ —Å–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è
- ‚úÖ –ù–µ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ KIE API
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è MockKieGateway

---

### üìå –®–ê–ì 4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–æ–≥–æ–≤ –∏ –æ—Ç—á—ë—Ç–æ–≤ ‚úÖ

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- ‚úÖ –í—Å–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å –¥–µ—Ç–∞–ª—è–º–∏
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–æ–≤ –æ–± –æ—à–∏–±–∫–∞—Ö
- ‚úÖ –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –æ—à–∏–±–æ–∫ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫—É –∏ —Ç–∏–ø—É

**–°–∫—Ä–∏–ø—Ç—ã:**
- `scripts/generate_error_report.py` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–æ–≤ –æ–± –æ—à–∏–±–∫–∞—Ö

---

### üìå –®–ê–ì 5: –ü—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏–µ –∫ –¥–µ–ø–ª–æ—é –Ω–∞ Render ‚úÖ

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- ‚úÖ –°–∫—Ä–∏–ø—Ç `scripts/pre_deploy_cleanup.py` –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –ë–î
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Å–µ—Å—Å–∏–π, –≥–µ–Ω–µ—Ä–∞—Ü–∏–π –∏ –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ –ë–î
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ DRY_RUN –æ–ø–µ—Ä–∞—Ü–∏–π

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
python scripts/pre_deploy_cleanup.py
```

---

### üìå –®–ê–ì 6: –ü—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –¥–µ–ø–ª–æ—è ‚úÖ

**–°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- ‚úÖ `render.yaml` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è Render
- ‚úÖ `README_DEPLOY_RENDER.md` - –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é
- ‚úÖ `DEPLOY_CHECKLIST.md` - —á–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º
- ‚úÖ `requirements.txt` - –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- ‚úÖ `config_runtime.py` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è runtime

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- ‚úÖ –í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç
- ‚úÖ `requirements.txt` —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è Render –≥–æ—Ç–æ–≤–∞

---

### üìå –®–ê–ì 7: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ ‚úÖ

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- ‚úÖ –°–∫—Ä–∏–ø—Ç `scripts/final_pre_deploy_check.py` –¥–ª—è –ø–æ–ª–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–∞ –æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
python scripts/final_pre_deploy_check.py
```

**–ü—Ä–æ–≤–µ—Ä—è–µ—Ç:**
1. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –º–æ–¥–µ–ª–µ–π
2. –û–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
3. –¢–µ—Å—Ç—ã –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é
4. –õ–æ–≥–∏ –∏ –æ—Ç—á—ë—Ç—ã
5. –ü–æ–¥–≥–æ—Ç–æ–≤–∫—É –∫ –¥–µ–ø–ª–æ—é
6. –ù–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤

---

## üìã –°–û–ó–î–ê–ù–ù–´–ï –§–ê–ô–õ–´

1. ‚úÖ `scripts/final_pre_deploy_check.py` - —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
2. ‚úÖ `scripts/pre_deploy_cleanup.py` - –æ—á–∏—Å—Ç–∫–∞ –ë–î –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º
3. ‚úÖ `render.yaml` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Render
4. ‚úÖ `README_DEPLOY_RENDER.md` - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é
5. ‚úÖ `DEPLOY_CHECKLIST.md` - —á–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

---

## üîß –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –î–õ–Ø RENDER

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```bash
TELEGRAM_BOT_TOKEN=your_bot_token
KIE_API_KEY=your_kie_api_key
DATABASE_URL=postgresql://...
ADMIN_ID=your_telegram_user_id
ALLOW_REAL_GENERATION=1
TEST_MODE=0
DRY_RUN=0
CREDIT_TO_RUB_RATE=0.1
KIE_API_URL=https://api.kie.ai
```

### Build Command:
```bash
pip install -r requirements.txt
```

### Start Command:
```bash
python bot_kie.py
```

---

## ‚úÖ –ß–ï–ö–õ–ò–°–¢ –ü–ï–†–ï–î –î–ï–ü–õ–û–ï–ú

- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å `python scripts/final_pre_deploy_check.py`
- [ ] –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å `python scripts/pre_deploy_cleanup.py`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä –ë–î (–Ω–µ –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–≤—ã—à–∞—Ç—å 1GB)
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Render
- [ ] –°–æ–∑–¥–∞—Ç—å PostgreSQL –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤ Render
- [ ] –ü–æ–¥–∫–ª—é—á–∏—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∫ Render
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–µ–ø–ª–æ–π

---

## üöÄ –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –î–ï–ü–õ–û–Æ

1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞:**
   ```bash
   python scripts/final_pre_deploy_check.py
   python scripts/pre_deploy_cleanup.py
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Render:**
   - –°–æ–∑–¥–∞–π—Ç–µ Web Service
   - –°–æ–∑–¥–∞–π—Ç–µ PostgreSQL Database
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
   - –ü–æ–¥–∫–ª—é—á–∏—Ç–µ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

3. **–î–µ–ø–ª–æ–π:**
   ```bash
   git add .
   git commit -m "Prepare for Render deploy"
   git push origin main
   ```

4. **–ü—Ä–æ–≤–µ—Ä–∫–∞:**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ Render Dashboard
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –±–æ—Ç–∞ –≤ Telegram
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç

---

## ‚úÖ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

**–í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã!**

**–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –¥–µ–ø–ª–æ—é –Ω–∞ Render!**

**–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!**

---

## üìû –ü–û–î–î–ï–†–ñ–ö–ê

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ Render Dashboard
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `scripts/final_pre_deploy_check.py`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã

---

**–ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é! üöÄ**

